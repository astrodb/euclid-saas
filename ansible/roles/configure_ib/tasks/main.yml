---
- name: Obtain hardware address
  command: "cat /sys/class/net/{{ ib_interface }}/address"
  register: result
  changed_when: false

- name: Set hardware address fact
  set_fact:
    ib_hwaddr: "{{ result.stdout }}"

- name: Copy ifcfg network script over
  template:
    src: ifcfg-ib0.j2
    dest: "/etc/sysconfig/network-scripts/ifcfg-{{ ib_interface }}"
  become: yes
  notify:
    - Reset interface

- name: Flush handlers
  meta: flush_handlers

- block:
    - name: Display ping host
      debug:
        msg: "Pinging {{ ib_ping_host }}"

    - name: Ping another host
      command: "ping -c1 {{ ib_ping_host }}"
  when: ib_ping_host is not none
...
